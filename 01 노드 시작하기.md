01 노드 시작하기
=======================
# 1. 핵심 개념 이해하기 
```
Node.js 는 크롬 V8 자바스크립트 엔진으로 빌드된 자바스크립트 런타입입니다.     
Node.js 는 이벤트 기반, 논블로킹 I/O 모델을 사용해 가볍고 효율적입니다.     
Node.js 의 패키지 생태계인 npm은 세계에서 가장 큰 오픈 소스 라이브러리 생태계이기도 합니다.  
```  
런타임 : 특정 언어로 만든 프로그램들을 실행할 수 있는 환경       
이벤트 기반 : 이벤트가 발생할 때 미리 지정해둔 작업을 수행하는 방식       
   
## 1.1. 자바 스크립트 런타임      
노드는 자바스크립트 런타임입니다.             
따라서 노드는 자바스크립트 프로그램을 컴퓨터에서 실행할 수 있게 해줍니다.       
           
자바스크립트를 브라우저가 아닌 다른 환경에서 사용하고자 했지만 엔진 속도가 문제였다. (느림)               
그러나 2009년 크롬의 **속도가 빠른 ```V8 엔진```이 등장**했으며 이를 기반으로 만들어지기 시작했다.     
      
노드는 ```V8``` 과 더불어 ```libuv``` 라는 라이브러리를 사용한다.       
**libuv 라이브러리**는 노드의 특성인 **이벤트 기반, 논블로킹 I/O 모델을 구현**하고 있다.    
그래서 이들을 이용해 **가볍고 효율적인 장점**을 가지고 있다.      
    
![노드1](https://user-images.githubusercontent.com/50267433/84773180-01d9aa80-b017-11ea-8f7d-d0311880f0fa.jpg)    

## 1.2. 이벤트 기반    
이벤트 기반 시스템에서는 특정 이벤트가 발생할 때 무엇을 할지 미리 등록해두어야 한다.      
이것을 **이벤트 리스너에 콜백 함수를 등록**한다고 표현한다.       
        
```클릭 이벤트 리스너 <- 경고창을 띄우는 콜백 함수 등록```         
이벤트가 발생할 때마다 콜백 함수가 실행돼 경고 창이 뜨게 된다.       
   
노드도 이벤트 기반 방식으로 동작하므로 이벤트가 발생하면 이벤트 리스너에 등록해둔 콜백 함수를 호출한다.     
발생한 이벤트가 없거나 발생했던 이벤트를 다 처리하면 노드는 다음 이벤트가 발생할 때까지 대기한다.      

## 1.3. 이벤트 루프
이벤트 루프 : 여러 이벤트가 동시에 발생했을 때 어떤 순서로 콜백 함수를 호출할지 판단  
노드는 자바스크립트 코드에서 맨 위부터 한 줄씩 실행합니다.   
함수 호출 부분을 발견했다면 호출한 함수를 호출 스택에 넣습니다.   

### 동기적 이벤트 루프
```javascript
function fisrt(){
   second();
   console.log('첫 번째');
}
function second(){
   third();
   console.log('두 번째');
}
function third(){
   console.log('첫 번째');
}
first();
```
  
![노드2](https://user-images.githubusercontent.com/50267433/84774816-50884400-b019-11ea-995a-3030b529cd04.jpg)
    
main 함수는 처음 실행 시의 전역 컨텍스트를 의미한다.        
컨텍스트 : 함수가 호출 되었을 때 생성되는 환경을 의미한다.         
자바 스크립트는 실행 시 기본적으로 전역 컨텍스트 안에서 돌아간다고 생각하는게 좋다.      
      
함수의 실행이 완료되면 호출 스택에서 지워지고 ```third -> second -> first -> main``` 순으로 완료된다.       
    
**결과**
```
세 번째
두 번째 
첫 번째  
```

### 비동기적 이벤트 루프
```javascript
function run(){
   console.log('3초 후 실행');
}
console.log('시작');
setTimeout(run, 3000);
console.log('끝');
```
**결과**
```
시작
끝 
3초 후 실행  
```
위 코드는 3초 뒤에 run 함수를 실행하는 코드이다.      
콘솔 결과는 쉽게 예측할 수 있지만, 호출 스택으로 설명하기는 힘듭니다.     
**setTimeout 함수의 콜백인 run이 호출 스택에 언제들어가는지 알기 어렵기 때문입니다.**
이를 위해서 루프, 태스크 큐, 백그라운드를 알아야 합니다

* **이벤트 루프 :** 이벤트 발생 시 호출할 콜백 함수들을 관리하고, 호출된 콜백 함수의 실행 순서를 경정하는 역할을 담당합니다.  
노드가 종료될 때까지 이벤트 처리를 위한 작업을 반복하므로 루프라고 불립니다.(호출 스택으로 보내기)     
* **태스크 큐 :** 이벤트 발생 후 호출되어야 할 콜백 함수들이 기다리는 공간입니다.   
콜백들이 이벤트 루프가 정한 순서대로 줄을 서 있으므로 콜백 큐라고 부릅니다.  
* **백그라운드 :** 타이머나 I/O 작업 콜백 또는 이벤트 리스너들이 대기하는 곳입니다.  

1. 일반적인 코드들은 호출 스택에 쌓인다.     
2. setTimout 과 같은 ```타이머```나 ```I/O 작업``` 실행시 해당 콜백은 백그라운드로 이동되어진다.              
3. 백그라운드에서 특정 시간, 조건이 지나면(예를 들면 3초 후) 해당 콜백을 태스크 큐로 보낸다.            
4. 기존 호출 스택 실행이 끝나 비워지면 (꼭 비워진 상태여야만 가능하다. 만약 안비워졌으면 예측 시간보다 더 걸릴 수 있다.)                      
5. 이벤트 루프가 태스크 큐에 저장된 콜백을 호출 스택으로 올린다.                     
6. 태스크 큐에서 올라온 콜백이 호출 스택에서 실행되고 스택은 비어진다.                    
7. 그리고 이벤트 루프는 태스크 큐에 콜백이 들어올 때까지 대기하게 된다.               




## 1.2. 소 주제
### 1.2.1. 내용1
```
내용1
```

***
# 2. 대주제
> 인용
## 2.1. 소 주제
### 2.1.1. 내용1
```
내용1
```   

***
# 3. 대주제
> 인용
## 3.1. 소 주제
### 3.1.1. 내용1
```
내용1
```
